N <- 328200000 # Total population of the United States (328.2 million)
Infected <- infected_us$value # isolating the infected subjects in the US dataset
Days <- infected_us$Days # Number of days since the first case
Infected_45 <- Infected[1:45]
Days <- 1:(length(Infected_45))
init <- c(
S = N - Infected_45[1],
I = Infected_45[1],
R = 0
)
Opt <- optim(c(0.5, 0.5),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
times <- 1:((Days)*3) # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[ , 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
times <- 1:((Days)^3) # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
times <- 1:150 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$times, fit[, 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
times <- 1:150 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
View(fit)
head(fit)
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
fit$time
fit[, 2:4]
times <- 1:100 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col)
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:150 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
45*3
times <- 1:45 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:150 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:100 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:100 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
head(fit)
times <- 1:100 # time in days
fit <- data.frame(ode(y = init, times = times, func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit$time, fit[ , 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = col, log = "y")
matplot(fit$time, fit[ , 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = col, inset = 0.05)
matplot(fit$time, fit[ , 2:4], type = "l",
xlab = "Day", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
# time in days for predictions
#t <- 1:as.integer(ymd(sir_end_date) + 1 - ymd(sir_start_date))
# get the fitted values from our SIR model
fitted_cumulative_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
View(fitted_cumulative_incidence)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence[, 2:4],
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
View(fitted_cumulative_incidence)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence[, 2],
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
head(fitted_cumulative_incidence)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence$I,
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence$I,
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fitted_cumulative_incidence$time, log(fitted_cumulative_incidence$I),
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence$I,
type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fitted_cumulative_incidence$time, fitted_cumulative_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", #log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
Infected_45 <- Infected[1:100]
Days <- 1:(length(Infected_45))
init <- c(
S = N - Infected_45[1],
I = Infected_45[1],
R = 0
)
Opt <- optim(c(0.5, 0.5),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", #log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
times <- 1:150 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit$time, fit[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", #log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:250 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fit$time, fit[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
matplot(fit_100$time, fit[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
matplot(fit_100$time, fit_100[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
times <- 1:150 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fit_100$time, fit_100[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
Infected_45 <- Infected[1:45]
Days <- 1:(length(Infected_45))
init <- c(
S = N - Infected_45[1],
I = Infected_45[1],
R = 0
)
Opt <- optim(c(0.5, 0.5),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
times <- 1:150 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fit_100$time, fit_100[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
matplot(fit_incidence$time, fit_incidence[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
View(infected_us)
head(infected_us, 30)
head(infected_us, 45)
head(infected_us, 60)
head(infected_us, 100)
Infected_60 <- Infected[1:60]
Days <- 1:(length(Infected_60))
init <- c(
S = N - Infected_60[1],
I = Infected_60[1],
R = 0
)
Opt <- optim(c(0.5, 0.5),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_45)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_60)
matplot(fit_incidence$time, fit_incidence[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
Opt <- optim(c(0.1, 0.1),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_60)
matplot(fit_incidence$time, fit_incidence[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:150 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
Opt <- optim(c(0.5, 0.5),
RSS,
method = "L-BFGS-B",
lower = c(0, 0),
upper = c(1, 1)
)
# optimize with some sensible conditions
Opt$message
# [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
Opt_par <- setNames(Opt$par, c("Beta", "Gamma"))
Opt_par
# get the fitted values from our SIR model
fit_incidence <- data.frame(ode(
y = init, times = Days,
func = SIR, parms = Opt_par
))
head(fit_incidence)
tail(fit_incidence)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_60)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", #log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_60)
matplot(fit_incidence$time, fit_incidence$I,
type = "l", log = "y",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1)
points(Days, Infected_60)
matplot(fit_incidence$time, fit_incidence[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:200 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
times <- 1:150 # time in days
fit_100 <- data.frame(ode(
y = init, times = times,
func = SIR, parms = Opt_par))
head(fit)
tail(fit)
cols <- 1:3 # colors: black = susceptible, red = infected and green = recovered
matplot(fit_100$time, fit_100[, 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols)
legend("left", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
matplot(fit_100$time, fit_100[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_45)
matplot(fit_100$time, fit_100[ , 2:4], type = "l",
xlab = "Days", ylab = "Number of subjects",
lwd = 2, lty = 1, col = cols, log = "y")
## Warning in xy.coords(x, y, xlabel, ylabel, log = log): 1 y value <= 0
## omitted from logarithmic plot
points(Days, Infected_60)
legend("bottomright", c("Susceptible", "Infected", "Recovered"),
lty = 1, lwd = 2, col = cols, inset = 0.05)
title("SIR model 2019-nCoV United States", outer = TRUE, line = -2)
