getwd()
package.names <- c('picante', 'pez', 'car', 'vegan', 'MASS', 'ecodist', 'FD', 'adephylo', 'phytools')
if ( ! (package.names[1] %in% installed.packages())) {install.packages(package.names[1], dependencies = T)}
library("PACKAGE NAME")
missing_pkgs <- package.names[which(!package.names %in% installed.packages())]
install.packages(missing_pkgs)
package.names <- c('ape', 'picante', 'pez', 'car', 'vegan', 'MASS', 'ecodist', 'FD', 'adephylo')
for (pkg in package.names) {
if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
install.packages(pkg)
library(pkg, character.only = TRUE)
}
}
trMB <- ape::read.tree("Data/ALLMB.CCESR.tre")
#trMB$tip.label <- gsub(" ", "_", phy$tip.label)
#trMB$tip.label <- gsub("sp.", "sp", trMB$tip.label)
length(trMB$tip.label)
head(trMB$tip.label)
BBSraw <- read.csv("Data/BBSpecies.biomass.2014.csv")[2:5]
bio.dat <- BBSraw
head(bio.dat)
bio.dat$Species <- gsub(" ", "_", bio.dat$Species)
bio.dat$Plot.Year <- paste(bio.dat$Plot, bio.dat$Year, sep = ";", collapse = NULL)   #join plot and year
bio.dat <- bio.dat[, -c(1, 2)]
bio.dat <- bio.dat[, c(3, 1, 2)]
oldsp <- c("Petalostemum_purpureum", "Petalostemum_candidum", "Petalostemum_villosum",
"Taraxicum_officinalis", "Leptoloma_cognatum", "Artemisia_.caudata._campestris",
"Achillea_millefolium.lanulosa.", "Euphorbia_.supina._maculata",
"Tragopogon_dubius_.major.",
"Ambrosia_artemisiifolia_elatior","Andropogon_gerardii", "Erigeron_canadensis")
newsp <- c("Dalea_purpurea", "Dalea_candida", "Dalea_pulchra",
"Taraxacum_croceum", "Digitaria_ciliaris", "Artemisia_caudata",
"Achillea_millefolium", "Euphorbia_supina", "Tragopogon_dubius",
"Ambrosia_artemisiifolia", "Andropogon_gerardii", "Erigeron_canadense")
for(i in 1:length(oldsp)){
cat("FROM", oldsp[i], "TO", newsp[i], "\n")
bio.dat$Species <- gsub(oldsp[i], newsp[i], bio.dat$Species)
}
#Get list of species in big bio
spnames <- unique(bio.dat$Species)
trMBcom <- drop.tip(trMB, setdiff(trMB$tip.label, spnames))
setdiff(spnames, trMBcom$tip.label)
bio.dat <- data.frame(na.omit(bio.dat))
head(bio.dat)
BBScom <- data.frame(sample2matrix(bio.dat))
BBScom[1:10, 1:10]
ls() # obtain the names of objects stored in the environment
rem <- ls()
rem
#rm(list = rem[2:10])
matched <- picante::match.phylo.comm(phy = trMBcom, comm = BBScom)
matched$comm[1:10, 1:10]
plot(matched$phy, show.tip.label = FALSE)
sum(matched$phy$edge.length) #  sum of the total branch lengths in the community
BBSpd <- pd(matched$comm, matched$phy, include.root = FALSE) # Faith's PD
head(BBSpd)
cor.test(BBSpd$SR, BBSpd$PD)
plot(BBSpd$SR, BBSpd$PD, xlab = "Species richness", ylab = "PD (millions of years)", pch = 16)
# MPD
dist.trMB <- cophenetic(matched$phy)
dist.trMB <- dist.trMB[lower.tri(dist.trMB, diag = FALSE)]
mean(dist.trMB)
# MNTD
dist.trMB2 <- cophenetic(matched$phy)
diag(dist.trMB2) <- NA
apply(dist.trMB2, 2, min, na.rm = TRUE)
mean(apply(dist.trMB2, 2, min, na.rm = TRUE))
BBSmpd <- mpd(matched$comm, cophenetic(matched$phy)) # MPD
head(BBSmpd)
BBSmntd <- mntd(matched$comm, cophenetic(matched$phy)) # MPD
head(BBSmntd)
# We can also calculate the standardized effect size of PD in each community
BBScdm <- ses.pd(matched$comm, matched$phy, runs = 99)
BBScdm <- BBScdm[, c(1, 2, 6, 7)]
head(BBScdm)
View(BBScdm)
package.names <- c('ape', 'picante', 'pez', 'car', 'vegan', 'MASS', 'ecodist', 'FD', 'adephylo')
for (pkg in package.names) {
if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
install.packages(pkg)
library(pkg, character.only = TRUE)
}
}
trMB <- ape::read.tree("Data/ALLMB.CCESR.tre")
#trMB$tip.label <- gsub(" ", "_", phy$tip.label)
#trMB$tip.label <- gsub("sp.", "sp", trMB$tip.label)
length(trMB$tip.label)
head(trMB$tip.label)
BBSraw <- read.csv("Data/BBSpecies.biomass.2014.csv")[2:5]
bio.dat <- BBSraw
head(bio.dat)
bio.dat$Species <- gsub(" ", "_", bio.dat$Species)
bio.dat$Plot.Year <- paste(bio.dat$Plot, bio.dat$Year, sep = ";", collapse = NULL)   #join plot and year
bio.dat <- bio.dat[, -c(1, 2)]
bio.dat <- bio.dat[, c(3, 1, 2)]
oldsp <- c("Petalostemum_purpureum", "Petalostemum_candidum", "Petalostemum_villosum",
"Taraxicum_officinalis", "Leptoloma_cognatum", "Artemisia_.caudata._campestris",
"Achillea_millefolium.lanulosa.", "Euphorbia_.supina._maculata",
"Tragopogon_dubius_.major.",
"Ambrosia_artemisiifolia_elatior","Andropogon_gerardii", "Erigeron_canadensis")
newsp <- c("Dalea_purpurea", "Dalea_candida", "Dalea_pulchra",
"Taraxacum_croceum", "Digitaria_ciliaris", "Artemisia_caudata",
"Achillea_millefolium", "Euphorbia_supina", "Tragopogon_dubius",
"Ambrosia_artemisiifolia", "Andropogon_gerardii", "Erigeron_canadense")
for(i in 1:length(oldsp)){
cat("FROM", oldsp[i], "TO", newsp[i], "\n")
bio.dat$Species <- gsub(oldsp[i], newsp[i], bio.dat$Species)
}
#Get list of species in big bio
spnames <- unique(bio.dat$Species)
trMBcom <- drop.tip(trMB, setdiff(trMB$tip.label, spnames))
setdiff(spnames, trMBcom$tip.label)
bio.dat <- data.frame(na.omit(bio.dat))
head(bio.dat)
BBScom <- data.frame(sample2matrix(bio.dat))
BBScom[1:10, 1:10]
ls() # obtain the names of objects stored in the environment
rem <- ls()
rem
#rm(list = rem[2:10])
rem
rm(list = rem[2:10])
matched <- picante::match.phylo.comm(phy = trMBcom, comm = BBScom)
matched$comm[1:10, 1:10]
plot(matched$phy, show.tip.label = FALSE)
sum(matched$phy$edge.length) #  sum of the total branch lengths in the community
BBSpd <- pd(matched$comm, matched$phy, include.root = FALSE) # Faith's PD
head(BBSpd)
cor.test(BBSpd$SR, BBSpd$PD)
plot(BBSpd$SR, BBSpd$PD, xlab = "Species richness", ylab = "PD (millions of years)", pch = 16)
# MPD
dist.trMB <- cophenetic(matched$phy)
dist.trMB <- dist.trMB[lower.tri(dist.trMB, diag = FALSE)]
mean(dist.trMB)
# MNTD
dist.trMB2 <- cophenetic(matched$phy)
diag(dist.trMB2) <- NA
apply(dist.trMB2, 2, min, na.rm = TRUE)
mean(apply(dist.trMB2, 2, min, na.rm = TRUE))
BBSmpd <- mpd(matched$comm, cophenetic(matched$phy)) # MPD
head(BBSmpd)
BBSmntd <- mntd(matched$comm, cophenetic(matched$phy)) # MPD
head(BBSmntd)
# We can also calculate the standardized effect size of PD in each community
BBScdm <- ses.pd(matched$comm, matched$phy, runs = 99)
BBScdm <- BBScdm[, c(1, 2, 6, 7)]
head(BBScdm)
require(phytools)
# Simpson's
BBSraoD <- raoD(matched$comm, force.ultrametric(matched$phy))
BBScdm$RaoD <- BBSraoD$Dkk
# SESMPD
BBSsesmpd <- ses.mpd(matched$comm, cophenetic(matched$phy), runs = 99)
BBScdm$MPD <- BBSsesmpd[, c(2)]
BBScdm$sesMPD <- BBSsesmpd[, c(6)]
BBScdm$MPDpval <- BBSsesmpd[, c(7)]
# SESMNTD
BBSsesmntd <- ses.mntd(matched$comm, cophenetic(matched$phy), runs = 99)
BBScdm$MNTD <- BBSsesmntd[, c(2)]
BBScdm$sesMNTD <- BBSsesmntd[, c(6)]
BBScdm$MNTDpval <- BBSsesmntd[, c(7)]
# PSV or phylogenetic species variability
BBSpsv <- psv(matched$comm, matched$phy, compute.var = TRUE)
BBScdm$PSV <- BBSpsv[, 1]
# PSR or phylogenetic species richness
BBSpsr <- psr(matched$comm, matched$phy, compute.var = TRUE)
BBScdm$PSR <- BBSpsr[, 1]
# PSR or phylogenetic species evenness
BBSpse <- pse(matched$comm, matched$phy)
BBScdm$PSE <- BBSpse[, 1]
# Scheiner 2012 qD(p)
source("RFunctions/qDp.R")
# Scheiner 2012 qD(p)
source("R-Functions/qDp.R")
BBSqDp <- qDp(matched$phy, matched$comm, q = 2)
BBScdm$qDP <-	BBSqDp
head(BBScdm, 10)
BBScdm2 <- BBScdm[, c(1, 2, 5, 6, 9, 12, 13, 14, 15)]
names(BBScdm2) <- c("SR", "PD", "RaoD", "MPD", "MNTD", "PSV", "PSR", "PSE", "qDP")
head(BBScdm2)
View(BBScdm)
head(BBScdm)
BBScdm2 <- BBScdm[, c(1, 2, 3, 5, 6, 7, 9, 10, 12, 13, 14, 15)]
names(BBScdm2) <- c("SR", "PD", "sesPD", "RaoD", "MPD", "sesMPD", "MNTD", "sesMNTD", "PSV", "PSR", "PSE", "qDP")
head(BBScdm2)
scatterplotMatrix(BBScdm)
cor(BBScdm)
cor.table(BBScdm)
cor.table(na.omit(BBScdm))
plot(BBScdm2$MPD, BBScdm2$PSV, xlab = "MPD", ylab = "PSV", pch = 17)
BBSmds <- metaMDS(BBScdm2, trace = FALSE)
BBSmds <- metaMDS(BBScdm2, trace = FALSE, na.rm = TRUE)
BBSmds <- metaMDS(na.omit(BBScdm2), trace = FALSE)
ordiplot(BBSmds, type = "t", display = "species")
na.omit(BBScdm2)
?metaMDS
BBSmds <- metaMDS(na.omit(BBScdm2))
ordiplot(BBSmds, type = "t", display = "species")
BBScdm2 <- BBScdm[, c(1, 2, 5, 6, 9, 12, 13, 14, 15)]
names(BBScdm2) <- c("SR", "PD", "RaoD", "MPD", "MNTD", "PSV", "PSR", "PSE", "qDP")
head(BBScdm2)
scatterplotMatrix(BBScdm)
cor.table(na.omit(BBScdm))
plot(BBScdm2$MPD, BBScdm2$PSV, xlab = "MPD", ylab = "PSV", pch = 17)
BBSmds <- metaMDS(na.omit(BBScdm2))
ordiplot(BBSmds, type = "t", display = "species")
BBSmds <- metaMDS(na.omit(BBScdm2), trace = FALSE)
ordiplot(BBSmds, type = "t", display = "species")
library(ape)
library(geiger)
library(nlme)
library(phytools)
library(geiger)
anoleData <- read.csv("Data/anolisDataAppended.csv", row.names = 1)
anoleTree <- read.tree("anolis.phy")
anoleData <- read.csv("Data/anolisDataAppended.csv", row.names = 1)
anoleTree <- read.tree("Data/anolis.phy")
plot(anoleTree)
plot.phylo(anoleTree, no.margin = T, cex = 0.5)
plot.phylo(anoleTree, type = "fan", no.margin = TRUE, cex = 0.7)
anoleTree
str(anoleTree)
anoleTree$tip.label
anoleTree$Nnode
anoleTree$edge
plot.phylo(anoleTree, type = "fan", no.margin = TRUE, cex = 0.7, label.offset = 0.1)
nodelabels(cex = 0.5)
tiplabels(cex = 0.5)
head(anoleData) # this will show you the first few rows of your data matrix and its header
dimnames(anoleData) # this will show you the row and column headers for your matrix
View(anoleData) # this will let you visualize the entire matrix
awe <- anoleData[, "awesomeness"]
names(awe) <- rownames(anoleData) # data vectors have to be labelled with tip names for the associated tree. This is how to do that.
brownianModel <- fitContinuous(anoleTree, awe)
brownianModel #this will show you the fit statistics and parameter values
hist(awe)
View(anoleData)
abline(v = 3.943316)
hist(awe, xlim = -4, 4)
hist(awe, xlim = c(-4, 4))
abline(v = 3.943316)
?fitContinuous
contMap(anoleTree, awe, fsize = 0.5, lwd = 3)
contMap(anoleTree, awe, fsize = 0.5, lwd = 3)
host <- anoleData[, "hostility"]
names(host) <- rownames(anoleData)
plot(host, awe, xlab = "hostility", ylab = "awesomeness")
lm_awehost <- lm(awe ~ host)
abline(lm_awehost)
lm_awehost <- lm(awe ~ host)
abline(lm_awehost)
lm_awehost <- lm(awe ~ host)
summary(lm_awehost)
plot(awe ~ host)
abline(lm_awehost)
plot(awe ~ host, xlab = "Hostility", ylab = "Awesomeness")
abline(lm_awehost)
plot(host, awe, xlab = "Hostility", ylab = "Awesomeness")
pglsModel <- gls(awesomeness ~ hostility, data = anoleData,
correlation = corBrownian(phy = anoleTree), method = "ML")
summary(pglsModel)
coef(pglsModel)
plot(awe ~ host, xlab = "Hostility", ylab = "Awesomeness")
abline(a = coef(pglsModel)[1], b = coef(pglsModel)[2]) #will plot the pgls regression line on your biplot.
library(ape)
library(geiger)
library(nlme)
library(phytools)
library(geiger)
library(rr2)
summary(pglsModel)
coef(pglsModel)
R2(pglsModel)
brownianModel <- fitContinuous(anoleTree, awe)
OUModel <- fitContinuous(anoleTree, awe, model = "OU")
EBModel <- fitContinuous(anoleTree, awe, model = "EB")
brownianModel
OUModel
EBModel
plot(host, awe, xlab = "hostility", ylab = "awesomeness", main = "Awesomeness as a Function of Hostility")
abline(lm_awehost, lty = 2) #uncorrected LM
abline(a = coef(pglsModel)[1], b = coef(pglsModel)[2]) #BM
legend("topright", lty = c(1, 2), legend = c("PGLS", "uncorrected"))
awehost.sum <- summary(lm_awehost)
awehost.sum$coef[2, 1]+c(-1, 1)*awehost.sum$coef[2, 2]
#for the uncorrected linear model
coef(pglsModel)[2]+c(-1, 1)*sqrt(pglsModel$varBeta[2, 2])
#for Brownian Motion, the 95% CI
island <- anoleData$island
names(island) <- rownames(anoleData)
island_anc <- make.simmap(anoleTree, island, model = "SYM", nsim = 100)
plotSimmap(island_anc[[1]], fsize = 0.5) # this plots the first of 100 simulations
island_summary <- summary(island_anc)
plot(island_summary, cex = c(0.5, 0.2), fsize = 0.5, offset = 90)
legend("bottomleft", fill = c("black", "red", "green", "blue"),
legend = c("Cuba", "Hispanola", "Jamaica", "PR"))
library(agricolae)
df <- read.csv("Data/BEF_Lesson_Data.csv", header = T)
names(df)
dim(df)
comp.cols <- c(rep("red", 12), rep("orange", 28), rep("yellow", 10), rep("green", 1))
with(df, plot(Comp, d_Y, col = comp.cols))
m1 <- lm(d_Y ~ Comp, data = df)
summary(m1)
anova(m1) # Use an ANOVA for categorical data
m1.df <- HSD.test(m1, "Comp", group = TRUE, console = TRUE)
with(df,plot(SR,d_Y)) #It's a little hard to assess the pattern graphically
m2 <- lm(d_Y ~ SR, data = df)
summary(m2) #A linear model indicates "no"
anova(m2) #ANOVA confirms this.
with(df, plot(Comp, NBE, col = comp.cols))
m3 <- lm(NBE ~ Comp, data = df)
summary(m3)
anova(m3)
m3.df <- HSD.test(m3, "Comp", group = TRUE, console = TRUE)
with(df, plot(SR, NBE)) #Note: it doesn't make sense to plot NBE of monocultures
m4 <- lm(NBE ~ SR, data = df)
summary(m4)
anova(m4)
m4.df <- HSD.test(m4, "SR", group = TRUE, console = TRUE)
with(df, plot(SR, CE))
m5 <- lm(CE ~ SR, data = df)
summary(m5)
anova(m5)
m5.df <- HSD.test(m5, "SR", group = TRUE, console = TRUE)
with(df, plot(SR, SE))
m6 <- lm(SE ~ SR, data = df)
summary(m6)
anova(m6)
m6.df <- HSD.test(m6, "SR", group = TRUE, console = TRUE)
with(df, plot(SR, CE, col = "blue"))
with(df, points(SR, SE, col = "red"))
abline(h = 0) #Just to make it easier to tell positive from negative
with(df, plot(SR, d_Y, ylim = c(-0.05, 0.25)))
#and add a horizontal line:
abline(h = 0)
m4 <- lm(NBE ~ SR, data = df)
summary(m4) #This is our old friend from question 2.
m7 <- lm(NBE ~ PSV, data = df)
summary(m7) # What about phylogenetic diversity?
m8 <- lm(NBE ~ FDis, data = df)
summary(m8) # Or functional diversity?
install.packages("~/Downloads/mee313285-sup-0004-supinfo2.gz", repos = NULL)
install.packages("~/Downloads/mee313285-sup-0004-supinfo2.gz")
install.packages("~/Downloads/mee313285-sup-0004-supinfo2.gz", repos = "both")
install.packages("partitionBEFsp")
library(partitionBEFsp)
?partitionBEFsp
#Monoculture biomasses for 57 species
M<-c(57.57, 2.33, 306.25, 172.42, 351.48, 280.15, 216.93,
1.30, 397.73, 185.57, 19.81, 162.45, 36.23, 42.48,
3.16, 250.12, 5.30, 58.06, 172.93, 210.50, 253.78,
15.96, 218.62, 282.00, 342.73, 242.18, 49.39, 100.00,
112.20, 181.50, 61.98, 428.82, 911.55, 80.60, 206.75,
108.25, 58.45, 154.55, 114.58, 144.38, 273.98, 25.41,
148.82, 48.27, 35.62, 168.45, 157.98, 100.47, 31.12,
9.86, 247.57, 182.32, 16.20, 251.30, 118.73, 137.65,
149.93)
#Polyculture biomasses for a community of 57 species
P<-c(31.82, 0.06, 6.93, 6.75, 0.00, 0.11, 0.00,
10.95, 0.19, 0.58, 0.01, 0.52, 21.72, 16.20,
0.00, 0.09, 3.42, 0.00, 0.02, 3.18, 8.86,
0.03, 0.02, 0.00, 10.14, 8.93, 4.53, 0.00,
0.00, 0.02, 8.80, 0.31, 21.47, 0.34, 14.52,
0.15, 0.00, 17.17, 66.55, 1.65, 0.44, 0.17,
7.11, 0.45, 5.37, 7.66, 4.37, 0.00, 120.08,
144.61, 0.00, 0.00, 0.00, 8.33, 93.18, 0.58,
1.77)
#calculate DRY
DRY<-calculate_DRY(M=M, P=P, Q=length(M))
M
P
DRY
#calculate classic partition for full community
classic_partition(DRY=DRY, M=M)
#note that sum of partition equals the change in yield,
#but only if sample-size corrected covariance isn't used
N<-length(M)
cp_F<-classic_partition(DRY=DRY, M=M, uncorrected_cov = FALSE)
cp_T<-classic_partition(DRY=DRY, M=M, uncorrected_cov = TRUE)
cp_C<-classic_partition(DRY=DRY, M=M, uncorrected_cov = "COMP")
sum(P-M/N) #observed - expected yield
cp_F$S+cp_F$C #default
cp_T$S+cp_T$C #non-sample-size corrected
cp_C$S+cp_C$C #compromise
sum(unlist(classic_partition(DRY=DRY, M=M, uncorrected_cov = "COMP", N=length(DRY), Q=N)))
sum(unlist(classic_partition(DRY=DRY, M=M, uncorrected_cov = "COMP", N=length(DRY), Q=N*2)))
####################################
# Example 2: Estimate population-level statistics
####################################
#estimate population-level partition for full community using only 30 species
set.seed(25123)
smp<-sample(30)
DRY_sample<-DRY[smp]
M_sample<-M[smp]
sample_to_population_partition(DRY=DRY_sample, M=M_sample, N=length(M_sample), Q=57)
#Repeat procedure for samples of between 2 and 57 species:
N_sample<-2:57
SP_est<-numeric(length(N_sample))
CP_est<-numeric(length(N_sample))
for(i in 1:length(N_sample)) {
#sample N random species
smp<-sample(1:57, N_sample[i])
pop_est<-sample_to_population_partition(DRY=DRY[smp], M=M[smp], N=N_sample[i], Q=57)
SP_est[i]<-pop_est$SP
CP_est[i]<-pop_est$CP
}
#Plot estimates vs. true value (dotted line)
plot(N_sample, SP_est, type="b"); abline(h=classic_partition(DRY=DRY, M=M)$S, lty=3, col=2)
plot(N_sample, CP_est, type="b"); abline(h=classic_partition(DRY=DRY, M=M)$C, lty=3, col=2)
#estimate expected value of sample-level statistics for a random sample of 30 species
#based on the full population of Q species
population_to_sample_partition(DRY=DRY, M=M, N=30, Q=57)
#Repeat procedure for samples of between 2 and 57 species:
N_sample<-2:57
SS_est<-numeric(length(N_sample))
CS_est<-numeric(length(N_sample))
for(i in 1:length(N_sample)) {
pop_est<-population_to_sample_partition(DRY=DRY, M=M, N=N_sample[i], Q=57)
SS_est[i]<-pop_est$SS
CS_est[i]<-pop_est$CS
}
#Plot estimates vs. true value (dotted line)
plot(N_sample, SS_est/N_sample, type="b")
abline(h=classic_partition(DRY=DRY, M=M)$S/57, lty=3, col=2)
#note - expected value of SS/N = SP/Q for all N
plot(N_sample, CS_est/N_sample, type="b")
abline(h=classic_partition(DRY=DRY, M=M)$C/57, lty=3, col=2)
####################################
# Example 4: Estimate confidence intervals
####################################
smp_ci<-sample_to_population_partition(DRY=DRY, M=M, Q=57, nboot=1000)
smp_ci$confint$bootdat_summary
library(partitionBEFsp)
?calculate_DRY
#Monoculture biomasses for 57 species
M <- c(57.57, 2.33, 306.25, 172.42, 351.48, 280.15, 216.93,
1.30, 397.73, 185.57, 19.81, 162.45, 36.23, 42.48,
3.16, 250.12, 5.30, 58.06, 172.93, 210.50, 253.78,
15.96, 218.62, 282.00, 342.73, 242.18, 49.39, 100.00,
112.20, 181.50, 61.98, 428.82, 911.55, 80.60, 206.75,
108.25, 58.45, 154.55, 114.58, 144.38, 273.98, 25.41,
148.82, 48.27, 35.62, 168.45, 157.98, 100.47, 31.12,
9.86, 247.57, 182.32, 16.20, 251.30, 118.73, 137.65,
149.93)
#Polyculture biomasses for a community of 57 species
P <- c(31.82, 0.06, 6.93, 6.75, 0.00, 0.11, 0.00,
10.95, 0.19, 0.58, 0.01, 0.52, 21.72, 16.20,
0.00, 0.09, 3.42, 0.00, 0.02, 3.18, 8.86,
0.03, 0.02, 0.00, 10.14, 8.93, 4.53, 0.00,
0.00, 0.02, 8.80, 0.31, 21.47, 0.34, 14.52,
0.15, 0.00, 17.17, 66.55, 1.65, 0.44, 0.17,
7.11, 0.45, 5.37, 7.66, 4.37, 0.00, 120.08,
144.61, 0.00, 0.00, 0.00, 8.33, 93.18, 0.58,
1.77)
#Monoculture biomasses for 50 species
M <- c(57.57, 2.33, 306.25, 172.42, 351.48, 280.15, 216.93,
1.30, 397.73, 185.57, 19.81, 162.45, 36.23, 42.48,
3.16, 250.12, 5.30, 58.06, 172.93, 210.50, 253.78,
15.96, 218.62, 282.00, 342.73, 242.18, 49.39, 100.00,
112.20, 181.50, 61.98, 428.82, 911.55, 80.60, 206.75,
108.25, 58.45, 154.55, 114.58, 144.38, 273.98, 25.41,
148.82, 48.27, 35.62, 168.45, 157.98, 100.47, 31.12,
9.86, 247.57)
#Polyculture biomasses for a community of 50 species
P <- c(31.82, 0.06, 6.93, 6.75, 0.00, 0.11, 0.00,
10.95, 0.19, 0.58, 0.01, 0.52, 21.72, 16.20,
0.00, 0.09, 3.42, 0.00, 0.02, 3.18, 8.86,
0.03, 0.02, 0.00, 10.14, 8.93, 4.53, 0.00,
0.00, 0.02, 8.80, 0.31, 21.47, 0.34, 14.52,
0.15, 0.00, 17.17, 66.55, 1.65, 0.44, 0.17,
7.11, 0.45, 5.37, 7.66, 4.37, 0.00, 120.08,
144.61)
#Monoculture biomasses for 50 species
M <- c(57.57, 2.33, 306.25, 172.42, 351.48, 280.15, 216.93,
1.30, 397.73, 185.57, 19.81, 162.45, 36.23, 42.48,
3.16, 250.12, 5.30, 58.06, 172.93, 210.50, 253.78,
15.96, 218.62, 282.00, 342.73, 242.18, 49.39, 100.00,
112.20, 181.50, 61.98, 428.82, 911.55, 80.60, 206.75,
108.25, 58.45, 154.55, 114.58, 144.38, 273.98, 25.41,
148.82, 48.27, 35.62, 168.45, 157.98, 100.47, 31.12,
9.86)
#Polyculture biomasses for a community of 50 species
P <- c(31.82, 0.06, 6.93, 6.75, 0.00, 0.11, 0.00,
10.95, 0.19, 0.58, 0.01, 0.52, 21.72, 16.20,
0.00, 0.09, 3.42, 0.00, 0.02, 3.18, 8.86,
0.03, 0.02, 0.00, 10.14, 8.93, 4.53, 0.00,
0.00, 0.02, 8.80, 0.31, 21.47, 0.34, 14.52,
0.15, 0.00, 17.17, 66.55, 1.65, 0.44, 0.17,
7.11, 0.45, 5.37, 7.66, 4.37, 0.00, 120.08,
144.61)
calculate_DRY
# calculate DRY
DRY <- calculate_DRY(M = M, P = P, Q = length(M))
?classic_partition
?classic_partition
#calculate classic partition for full community
NBE <- classic_partition(DRY = DRY, M = M)
SE <- NBE$S
CE <- NBE$C
SE
CE
